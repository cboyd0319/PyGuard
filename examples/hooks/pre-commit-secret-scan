#!/bin/bash
# PyGuard pre-commit hook for secret scanning
# Copy this file to .git/hooks/pre-commit and make it executable
# chmod +x .git/hooks/pre-commit

# Fast secret scan on staged files
git diff --cached --name-only --diff-filter=ACM | grep "\.py$" | \
  xargs pyguard --scan-secrets --exit-on-error

# Exit code 1 if secrets found
if [ $? -ne 0 ]; then
    echo "❌ Secrets detected! Commit blocked."
    echo "Remove hardcoded secrets before committing."
    exit 1
fi

echo "✅ No secrets detected"
exit 0
