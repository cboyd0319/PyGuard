#!/bin/bash
# PyGuard pre-commit hook with fast mode
# Copy this file to .git/hooks/pre-commit and make it executable
# chmod +x .git/hooks/pre-commit

# Get staged Python files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep "\.py$")

if [ -z "$STAGED_FILES" ]; then
    echo "No Python files to check"
    exit 0
fi

echo "Running PyGuard fast security scan on staged files..."

# Run PyGuard with fast mode on staged files
echo "$STAGED_FILES" | xargs pyguard --fast --scan-only --no-html

if [ $? -ne 0 ]; then
    echo "❌ Security issues detected! Please fix before committing."
    exit 1
fi

echo "✅ All security checks passed"
exit 0
