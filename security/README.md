# PyGuard Security Documentation

This directory contains comprehensive security documentation, policies, and analysis for the PyGuard project.

## üìÅ Directory Structure

```
security/
‚îú‚îÄ‚îÄ README.md                          # This file
‚îú‚îÄ‚îÄ RISK_LEDGER.md                     # Risk assessment and tracking
‚îú‚îÄ‚îÄ THREAT_MODEL.md                    # STRIDE-based threat analysis
‚îú‚îÄ‚îÄ SECURE_CODING_GUIDE.md            # Python security best practices
‚îú‚îÄ‚îÄ POLICIES/
‚îÇ   ‚îî‚îÄ‚îÄ semgrep/
‚îÇ       ‚îî‚îÄ‚îÄ python-security-custom.yml # Custom Semgrep security rules
‚îî‚îÄ‚îÄ SCANNER_RESULTS/                   # Security scan outputs (gitignored)
```

## üìö Documentation

### [RISK_LEDGER.md](./RISK_LEDGER.md)
Complete risk assessment for PyGuard, including:
- **Current Risks** - Active security concerns with mitigation status
- **Risk Scoring** - Likelihood √ó Impact methodology
- **Mitigated Risks** - Completed security improvements
- **Quick Wins** - High-priority, low-effort improvements
- **Security Roadmap** - Phased security enhancement plan

**Read this first** to understand PyGuard's security posture.

### [THREAT_MODEL.md](./THREAT_MODEL.md)
STRIDE-based threat modeling covering:
- **System Context** - Trust boundaries and data flows
- **Threat Actors** - Adversary capabilities and motivations
- **Threat Catalog** - 10 major threat scenarios with mitigations
- **Security Controls** - Implemented and planned defenses
- **Incident Response** - Procedures for handling security issues

**Use this** for understanding attack vectors and defenses.

### [SECURE_CODING_GUIDE.md](./SECURE_CODING_GUIDE.md)
Comprehensive secure coding practices for Python:
- **Input Validation** - Safe handling of user input
- **Injection Prevention** - Command, SQL, template injection defense
- **Deserialization Security** - Safe pickle/YAML/JSON handling
- **Path Traversal Prevention** - File system security
- **Secrets Management** - Credential handling best practices
- **Cryptography** - Strong crypto algorithms and patterns
- **Error Handling** - Safe error messages without information leakage
- **Logging Security** - Sanitized logging without secret exposure

**Reference this** when writing or reviewing code.

## üõ°Ô∏è Security Policies

### Semgrep Custom Rules

Location: `POLICIES/semgrep/python-security-custom.yml`

**17 Custom Security Rules:**
1. Unsafe `eval()` detection
2. Unsafe `exec()` detection
3. Pickle deserialization risks
4. YAML unsafe loading
5. Shell injection via subprocess
6. SQL injection patterns
7. Hardcoded secrets
8. Weak cryptography (MD5/SHA1)
9. Path traversal vulnerabilities
10. Insecure random numbers
11. Template injection (Jinja2)
12. Debug mode in production
13. Assert statements for security
14. Catch-all exception handlers
15. Tarfile extraction risks
16. XML external entity (XXE)
17. Insecure temporary files

**Usage:**
```bash
# Run custom rules locally
semgrep --config security/POLICIES/semgrep/python-security-custom.yml pyguard/

# Or in CI (automatically applied)
```

## üîç Scanner Results

The `SCANNER_RESULTS/` directory (gitignored) stores outputs from:
- Bandit SAST scans
- Semgrep security analysis
- pip-audit vulnerability reports
- OSV-Scanner findings
- Safety DB checks
- Gitleaks secret detection

These are generated by CI/CD and uploaded as artifacts.

## üöÄ Quick Start

### For Security Reviewers

1. **Read the Risk Ledger** - Understand current security posture
2. **Review the Threat Model** - Learn about attack scenarios
3. **Check Scanner Results** - Look at latest CI artifacts
4. **Audit Code Changes** - Use the Secure Coding Guide

### For Contributors

1. **Read Secure Coding Guide** - Learn Python security best practices
2. **Run Local Scans** - Test your changes before committing
   ```bash
   bandit -r pyguard/
   semgrep --config security/POLICIES/semgrep/ pyguard/
   ```
3. **Review Threat Model** - Consider security implications
4. **Update Documentation** - Keep security docs current

### For Security Researchers

1. **Review Threat Model** - Understand attack surface
2. **Check Risk Ledger** - See known issues and mitigations
3. **Report Vulnerabilities** - Via [GitHub Security Advisories](https://github.com/cboyd0319/PyGuard/security/advisories/new)
4. **Follow Disclosure Policy** - See `../SECURITY.md`

## üìä Security Metrics

### OSSF Scorecard
- **Current Target:** 9+/10
- **Measured Weekly:** Via GitHub Actions
- **View Results:** GitHub Security tab

### Test Coverage
- **Minimum Coverage:** 87%
- **Security Tests:** Dedicated `tests/test_security*.py`
- **Mutation Testing:** Planned for Phase 3

### Vulnerability Response
- **Initial Response:** < 3 business days
- **Status Updates:** Weekly
- **Resolution Target:** 30 days (high/critical)

## üîÑ Update Schedule

- **Risk Ledger:** Quarterly reviews
- **Threat Model:** After major features or annually
- **Secure Coding Guide:** As new patterns emerge
- **Semgrep Rules:** Monthly reviews
- **Scanner Results:** Every CI run

## üÜò Emergency Contacts

For security incidents:
1. **Report:** [GitHub Security Advisories](https://github.com/cboyd0319/PyGuard/security/advisories/new)
2. **Email:** security@pyguard.dev (if configured)
3. **Escalation:** @cboyd0319

## üîó External Resources

### OWASP
- [OWASP Top 10](https://owasp.org/www-project-top-ten/)
- [Python Security Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/Python_Security_Cheat_Sheet.html)

### CWE
- [CWE Top 25](https://cwe.mitre.org/top25/)
- [CWE Python Weakness List](https://cwe.mitre.org/data/definitions/1000.html)

### Supply Chain
- [SLSA Framework](https://slsa.dev/)
- [OSSF Best Practices](https://bestpractices.coreinfrastructure.org/)
- [Sigstore](https://www.sigstore.dev/)

### Tools
- [Bandit Documentation](https://bandit.readthedocs.io/)
- [Semgrep Registry](https://semgrep.dev/explore)
- [pip-audit](https://github.com/pypa/pip-audit)
- [OSV](https://osv.dev/)

## üìù Contributing to Security Docs

### Making Updates

1. **Fork and Branch** - Create a feature branch
2. **Make Changes** - Update relevant documents
3. **Validate** - Ensure examples work and links are valid
4. **Submit PR** - Request review from security team
5. **Address Feedback** - Iterate based on review

### Documentation Standards

- **Clarity** - Write for mixed technical levels
- **Examples** - Provide code samples (both bad and good)
- **References** - Link to official sources (CWE, OWASP, etc.)
- **Maintenance** - Include "Last Updated" dates
- **Versioning** - Note which PyGuard versions apply

## üèÜ Security Achievements

- ‚úÖ **Comprehensive Security Documentation** - Complete threat model and guides
- ‚úÖ **Multi-Scanner CI/CD** - Bandit, Semgrep, CodeQL, OSSF Scorecard
- ‚úÖ **Custom Security Rules** - 17 Semgrep rules for Python
- ‚úÖ **Supply Chain Security** - SBOM, provenance, dependency scanning
- ‚úÖ **Secrets Detection** - Gitleaks integration
- ‚úÖ **SHA-Pinned Actions** - All workflows use commit SHAs
- üîÑ **Sigstore Signing** - In progress
- üîÑ **SLSA Level 3** - Planned

---

**Version:** 1.0  
**Last Updated:** 2025-10-19  
**Maintained By:** PyGuard Security Team
